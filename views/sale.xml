<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!--Template pára formulario de datos del cliente-->
    <template id="form_address_imagen" name="Formulario de datos del cliente">
         <div class="row">
            <div class="col-12 col-md-12 col-xl-12 mt-3">
                <div class="alert alert-warning" role="alert">
                    Está editando los datos de facturación y envió. Por favor revise detenidamente los
                    datos proporcionados.
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-md-12 col-xl-12">
                <form id="checkout_form_imagen" class="checkout_autoformat" action="/shop/address" method="post">
                    <div class="row">
                        <div class="col-12 col-md-12 col-xl-12">
                            <div t-attf-class="form-group #{error.get('name') and 'o_has_error' or ''} div_name">
                                <label class="col-form-label" for="name">Nombre</label>
                                <input type="text" name="name" t-attf-class="form-control #{error.get('name') and 'is-invalid' or ''}" t-att-value="'name' in checkout and checkout['name']" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-6 col-xl-6">
                            <t t-if="mode[1] == 'billing' ">
                                <div t-attf-class="form-group #{error.get('email') and 'o_has_error' or ''}" id="div_email">
                                    <label class="col-form-label" for="email">Correo electrónico</label>
                                    <input type="email" name="email" t-attf-class="form-control #{error.get('email') and 'is-invalid' or ''}" t-att-value="'email' in checkout and checkout['email']" />
                                </div>
                            </t>
                        </div>
                        <div class="col-12 col-md-6 col-xl-6">
                            <div t-attf-class="form-group #{error.get('phone') and 'o_has_error' or ''}" id="div_phone">
                                <label class="col-form-label" for="phone">Teléfono</label>
                                <input type="tel" name="phone" t-attf-class="form-control #{error.get('phone') and 'is-invalid' or ''}" t-att-value="'phone' in checkout and checkout['phone']" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-12 col-xl-12">
                            <div t-attf-class="form-group #{error.get('street') and 'o_has_error' or ''} div_street">
                                <label class="col-form-label" for="street">Dirección</label>
                                <input type="text" name="street" t-attf-class="form-control #{error.get('street') and 'is-invalid' or ''}" t-att-value="'street' in checkout and checkout['street']" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-6 col-xl-6">
                            <div t-attf-class="form-group #{error.get('company_name') and 'o_has_error' or ''}">
                                <label class="col-form-label font-weight-normal label-optional" for="company_name">Nombre de la empresa</label>
                                <input type="text" name="company_name" t-attf-class="form-control #{error.get('company_name') and 'is-invalid' or ''}"
                                       t-att-value="'commercial_company_name' in checkout and checkout['commercial_company_name'] or 'company_name' in checkout and checkout['company_name']"
                                       t-att-readonly="'1' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None"
                                       t-att-title="'Changing company name is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" />
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-xl-6">
                            <div t-attf-class="form-group #{error.get('vat') and 'o_has_error' or ''} div_vat">
                                <label class="col-form-label font-weight-normal label-optional" for="vat">NIT</label>
                                <input type="text" name="vat" t-attf-class="form-control #{error.get('vat') and 'is-invalid' or ''}"
                                       t-att-value="'vat' in checkout and checkout['vat']"
                                       t-att-readonly="'1' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None"
                                       t-att-title="'Changing VAT number is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-md-7 col-xl-7">
                            <div t-attf-class="form-group #{error.get('city') and 'o_has_error' or ''} div_city">
                                <label class="col-form-label" for="city">Ciudad</label>
                                <input type="text" name="city" t-attf-class="form-control #{error.get('city') and 'is-invalid' or ''}" t-att-value="'city' in checkout and checkout['city']" />
                            </div>
                        </div>
                        <div class="col-12 col-md-5 col-xl-5">
                            <t t-set='zip_city' t-value='country and [x for x in country.get_address_fields() if x in ["zip", "city"]] or ["city", "zip"]'/>
                            <t t-if="'zip' in zip_city and zip_city.index('zip') &lt; zip_city.index('city')">
                                <div t-attf-class="form-group #{error.get('zip') and 'o_has_error' or ''} div_zip">
                                    <label class="col-form-label label-optional" for="zip">Código de área</label>
                                    <input type="text" name="zip" t-attf-class="form-control #{error.get('zip') and 'is-invalid' or ''}" t-att-value="'zip' in checkout and checkout['zip']" />
                                </div>
                            </t>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6">
                            <div t-attf-class="form-group #{error.get('country_id') and 'o_has_error' or ''} div_country">
                                <label class="col-form-label" for="country_id">País</label>
                                <select id="country_id" name="country_id" t-attf-class="form-control #{error.get('country_id') and 'is-invalid' or ''}">
                                    <option value="">Country...</option>
                                    <t t-foreach="countries" t-as="c">
                                        <option t-att-value="c.id" t-att-selected="c.id == (country and country.id or -1)">
                                            <t t-esc="c.name" />
                                        </option>
                                    </t>
                                </select>
                            </div>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6">
                             <div t-attf-class="form-group #{error.get('state_id') and 'o_has_error' or ''} div_state" t-att-style="(not country or not country.state_ids) and 'display: none'">
                                 <label class="col-form-label" for="state_id">Departamento</label>
                                 <select name="state_id" t-attf-class="form-control #{error.get('state_id') and 'is-invalid' or ''}" data-init="1">
                                    <option value="">Departamento</option>
                                    <t t-foreach="country and country.state_ids or []" t-as="s">
                                        <option t-att-value="s.id" t-att-selected="s.id == ('state_id' in checkout and country and checkout['state_id'] != '' and int(checkout['state_id']))">
                                            <t t-esc="s.name" />
                                        </option>
                                    </t>
                                </select>
                             </div>
                        </div>
                    </div>

                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <input type="hidden" name="submitted" value="1" />
                    <input type="hidden" name="partner_id" t-att-value="partner_id or '0'" />
                    <input type="hidden" name="callback" id="callback" t-att-value="callback" />
                    <!-- Example -->
                    <input type="hidden" name="field_required" t-att-value="'phone,name'" />

                    <div class="row">
                        <div class="col-12 col-md-12 col-xl-12">
                            <label class="col-form-label">Selecciona tu forma de entrega</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 col-md-4 col-xl-4">
                            <a role="button" href="#" class="btn-continue btn mb32 a-submit-form-xpress a-submit-disable a-submit-loading">
                                Retiro en tienda
                            </a>
                        </div>

                        <div class="col-6 col-md-6 col-xl-6">
                            <a role="button" href="#" class="btn-continue btn mb32 a-submit-form-checkout a-submit-disable a-submit-loading">
                                Envío a domicilio
                            </a>
                        </div>
                    </div>

                    <!--
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6 text-left">
                            <a role="button" href="/shop/cart" class="btn-continue btn mb32">
                                <i class="fa fa-chevron-left"/>
                                <span>Anterior</span>
                            </a>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6 text-right">
                            <a role="button" href="#" class="btn-continue btn mb32 a-submit-form-checkout a-submit-disable a-submit-loading">
                                <span>Siguiente</span>
                                <i class="fa fa-chevron-right"/>
                            </a>
                        </div>
                    </div>
                    -->
                </form>
            </div>
        </div>
    </template>

    <template id="invoice_address">
        <div class="container">
                <h5 class="shopping-title-invoice text-center">DETALLE DE PAGO</h5>
                <div class="invoice-cart">
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice text-left">
                                <span t-esc="website_sale_order.cart_quantity"/>
                                <t t-if="website_sale_order.cart_quantity == 1">
                                    articulo
                                </t>
                                <t t-else="">
                                    articulos
                                </t>
                            </p>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice-money text-right" id="amount_untaxed_product_imagen">
                                <span t-esc="website_sale_order.amount_untaxed - website_sale_order.amount_delivery" class="monetary_field" style="white-space: nowrap;"
                                  t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice text-left">Cargo por envio</p>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice-money text-right" id="amount_delivery_imagen">
                                <span t-field="website_sale_order.amount_delivery" class="monetary_field" style="white-space: nowrap;"
                                      t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice text-left">Subtotal</p>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice-money text-right" id="amount_untaxed_imagen">
                                <span t-field="website_sale_order.amount_untaxed" class="monetary_field" style="white-space: nowrap;"
                                      t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice text-left">Impuestos</p>
                        </div>
                        <div class="col-6 col-md-6 col-xl-6">
                            <p class="label-invoice-money text-right" id="amount_tax_imagen">
                                <span t-field="website_sale_order.amount_tax" style="white-space: nowrap;" class="monetary_field"
                                      t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}" />
                            </p>
                        </div>
                    </div>
                     <div class="row">
                        <div class="col-12">
                            <hr/>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-6">
                            <p class="label-invoice text-left">Total</p>
                        </div>
                        <div class="col-6">
                            <p class="label-invoice-money text-right" id="amount_total_imagen">
                                <strong t-field="website_sale_order.amount_total" class="monetary_field"
                                  t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}'/>
                            </p>
                        </div>
                    </div>
                    <t t-if="show_buy == 1">
                        <div class="row">
                            <div class="col-12 col-md-12 col-xl-12 text-right mb-3">
                                <a  class="btn btn-primary btn-pay-now" href="/shop/address">
                                    PAGAR AHORA
                                </a>
                            </div>
                        </div>
                    </t>
                </div>
            </div>
    </template>

    <template id="checkout_imagen">
        <div class="detail-sale" id="checkout-imagen">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-7 col-xl-7">
                        <div class="container">
                            <h5 class="shopping-title">DIRECCIÓN DE ENTREGA</h5>
                            <hr/>
                            <div class="row">
                                <div class="col-10 col-md-11 col-xl-11 p-3">
                                    <h5 class="text-left">Dirección de facturación</h5>
                                    <p class="text-justify text-wrap">Bulevar Sergio Viera de Mello #307 Colonia San Benito San Benito San Salvador SV, CP 1101, Bulevar Sergio Viera De Mello, San Salvador</p>
                                </div>
                                <div class="col-2 col-md-1 col-xl-1 text-right">
                                    <a href="#">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12 col-md-12 col-xl-12 one_kanban">
                                    <form action="/shop/address" method="post" class='form-add-address'>
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                                        <a role="button" href="#" class='a-submit-add-address btn btn-continue mb16 btn-block'>
                                            <i class="fa fa-plus-square"/>
                                            <span>Agregar dirección</span>
                                        </a>
                                    </form>
                                </div>
                            </div>
                            <div class="row all_shipping">
                                <t t-foreach="shippings" t-as="ship">
                                    <div class="col-6 col-md-6 col-xl-6 one_kanban">
                                        <t t-call="sitio_imagen.item_address">
                                            <t t-set="actual_partner" t-value="order.partner_id" />
                                            <t t-set='contact' t-value="ship"/>
                                            <t t-set='selected' t-value="order.partner_shipping_id==ship"/>
                                            <t t-set='readonly' t-value="bool(len(shippings)==1)"/>
                                            <t t-set='edit_billing' t-value="bool(ship==order.partner_id)"/>
                                        </t>
                                    </div>
                                </t>
                            </div>
                            <div class="row">
                                <div class="col-12 col-md-12 col-xl-12 text-right mr-5 mb-3">
                                    <a class="btn-continue btn btn-next-step"  href="/shop/confirm_order">
                                        CONTINUAR
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-5 col-xl-5">
                        <t t-set="show_buy" t-value="0"/>
                        <t t-call="sitio_imagen.invoice_address"/>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            document.body.classList.add('page');
        </script>
    </template>

    <template id="item_address">
        <form action="/shop/checkout" method="POST" class="d-none">
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
            <input type="hidden" name="partner_id" t-att-value="contact.id" />
            <t t-if='edit_billing'>
                <input type="hidden" name="callback" value="/shop/checkout?use_billing" />
            </t>
            <input type='submit'/>
        </form>
        <div t-attf-class="row item-address #{selected and 'border border-primary' or 'js_change_shipping'}">
            <div class="col-12 col-md-12 col-xl-12">
                <div class="row">
                    <div class="col-10 col-md-10 col-xl-10">
                        <p class="text-justify" t-esc="contact" t-options="dict(widget='contact', fields=['name', 'address'], no_marker=True)">
                        </p>
                    </div>
                    <div class="col-2 col-md-2 col-xl-2 text-right">
                        <a t-if="not actual_partner or (ship.id in actual_partner.child_ids.ids)" href="#"
                           class="btn btn-link float-right p-0 js_edit_address no-decoration"
                           role="button" title="Editar esta dirección" aria-label="Editar esta dirección">
                            <i class='fa fa-edit'/>
                        </a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12 pb-3">
                        <span class='btn-ship' t-att-style="'' if selected else 'display:none;'">
                            <a role="button" href='#' class="btn btn-block btn-continue">
                                <i class='fa fa-check'></i> Enviar a esta dirección
                            </a>
                        </span>
                        <span class='btn-ship' t-att-style="'' if not selected else 'display:none;'">
                            <a role="button" href='#' class="btn btn-block btn-continue">
                                Seleccionar esta dirección
                            </a>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </template>
    <template id="address_imagen">
        <div class="detail-sale" id="detail_sale_imagen">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-7 col-xl-7 order-md-1 order-xl-1 order-2">
                        <div class="container">
                            <h5 class="shopping-title">PROCESO DE PAGO</h5>
                            <hr/>
                            <div class="row">
                                <div class="col-12 col-md-12 col-xl-12">
                                    <a class="a-title-step collapsed" href="#collapseStepOne" data-toggle="collapse" aria-expanded="false" aria-controls="collapseStepOne">
                                        COMPLETA TUS DATOS
                                    </a>
                                    <div class="container collapse show" id="collapseStepOne">
                                        <t t-call="sitio_imagen.form_address_imagen"/>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-5 col-xl-5 order-md-2 order-xl-2 order-1">
                        <t t-set="show_buy" t-value="0"/>
                        <t t-call="sitio_imagen.invoice_address"/>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            document.body.classList.add('page');
        </script>
    </template>

    <!--Metodos de pago-->
    <template id="payment_methods_imagen">
        <div class="row">
            <form t-if="pms or acquirers" method="post" class="o_payment_form mt-3 clearfix w-100"
                  t-att-action="form_action if form_action else '#'"
                  t-att-data-success-url="success_url or ''"
                  t-att-data-error-url="error_url or ''"
                  t-att-data-access-token="access_token or ''"
                  t-att-data-partner-id="partner_id"
                  t-att-data-callback-method="callback_method or ''"
                  t-att-data-order-id="order_id or ''"
                  t-att-data-mode="mode">

                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <input type="hidden" t-if="prepare_tx_url" name="prepare_tx_url" t-att-value="prepare_tx_url"/>
                <input type="hidden" t-if="order_id" name="order_id" t-att-value="order_id"/>
                <!-- s2s form submission -->
                <input type="hidden" t-if="access_token" name="access_token" t-att-value="access_token"/>
                <input type="hidden" t-if="success_url" name="success_url" t-att-value="success_url"/>
                <input type="hidden" t-if="error_url" name="error_url" t-att-value="error_url"/>
                <input type="hidden" t-if="callback_method" name="callback_method" t-att-value="callback_method"/>

                <div class="col-12 col-md-12 col-xl-12">
                    <div class="row">
                        <t t-set="acquirers_count" t-value="len(acquirers) if acquirers else 0"/>
                        <t t-set="pms_count" t-value="len(pms) if pms else 0"/>
                        <t t-set="MAX_BRAND_LINE" t-value="3"/>

                        <t t-foreach="acquirers" t-as="acq">
                            <div class="col-12 col-md-12 col-xl-12 mt-3">
                                <p class="text-left title-payment-method font-size-14 text-red-hands">
                                    <t t-if="acq.payment_flow == 'form'">
                                        <input type="radio" t-att-data-acquirer-id="acq.id"
                                               t-att-data-form-payment="true"
                                               t-att-data-provider="acq.provider"
                                               t-att-class="'d-none' if (acquirers_count==1 and pms_count==0) else ''"
                                               name="pm_id" t-attf-value="form_{{acq.id}}"
                                               t-att-checked="acquirers_count==1 and pms_count==0 or acquirers[0] == acq"
                                        />
                                    </t>
                                    <t t-else="acq.payment_flow == 's2s'">
                                        <input type="radio" t-att-data-acquirer-id="acq.id"
                                               t-att-data-s2s-payment="true"
                                               t-att-data-provider="acq.provider"
                                               name="pm_id" t-attf-value="new_{{acq.id}}"
                                               t-att-class="'d-none' if (acquirers_count==1 and pms_count==0) else ''"
                                               t-att-checked="acquirers_count==1 and pms_count==0 or acquirers[0] == acq"
                                        />
                                    </t>
                                    <span class="payment_option_name font-size-14 text-red-hands">
                                        <t t-esc="acq.display_as or acq.name"/>
                                        <!--
                                        <div t-if="acq.state == 'test'" class="badge-pill badge-warning float-right" style="margin-left:5px">
                                            Test Mode
                                        </div>
                                        -->
                                    </span>
                                    <t t-if="acq_extra_fees and acq_extra_fees.get(acq)">
                                        <span class="badge badge-pill badge-secondary"> +
                                            <t t-esc="acq_extra_fees[acq]" t-options='{"widget": "monetary", "display_currency": acq_extra_fees["currency_id"]}'/>
                                            Fee
                                        </span>
                                    </t>
                                    <t t-elif="acq.fees_active">
                                        <small class="text-muted">(Some fees may apply)</small>
                                    </t>
                                </p>
                                <t t-if="len(acq.payment_icon_ids) &gt; 0">
                                    <ul class="list-inline">
                                        <t t-set="i" t-value="0"/>
                                        <t t-foreach="acq.payment_icon_ids" t-as="pm_icon">
                                            <li t-attf-class="list-inline-item#{'' if (i &lt; MAX_BRAND_LINE) else ' d-none'}">
                                                <span t-field="pm_icon.image_payment_form" t-options='{"widget": "image", "alt-field": "name", "class": "pm-icon m-1"}'/>
                                            </li>
                                            <li t-if="i==MAX_BRAND_LINE" style="display:block;" class="list-inline-item">
                                                <span class="float-right more_option text-info">
                                                    <a href="#" class="o_payment_form_pay_icon_more"
                                                       data-toggle="tooltip"
                                                       t-att-title="', '.join([opt.name for opt in acq.payment_icon_ids[MAX_BRAND_LINE:]])">
                                                        <i class="fa fa-plus"></i>
                                                    </a>
                                                </span>
                                            </li>
                                            <t t-set="i" t-value="i+1"/>
                                        </t>
                                    </ul>
                                    <div t-raw="acq.pre_msg" class="text-muted ml-3"/>
                                </t>
                            </div>
                            <t t-if="acq.payment_flow == 'form'">
                                <div t-attf-id="o_payment_form_acq_{{acq.id}}"
                                     t-attf-class="d-none {{'card-footer' if acq.save_token == 'ask' else ''}}">
                                    <label t-if="acq.save_token == 'ask'">
                                        <input type="checkbox" name="o_payment_form_save_token" data-remove-me=""/>
                                        Guardar mis datos de pago
                                    </label>
                                    <t t-if="acq.save_token == 'always'">
                                        <input type="checkbox" name="o_payment_form_save_token" checked="'checked'" class="o_hidden" data-remove-me=""/>
                                    </t>
                                </div>
                            </t>
                            <t t-else="acq.payment_flow == 's2s'">
                                <div t-attf-id="o_payment_add_token_acq_{{acq.id}}"
                                     t-attf-class="card-footer {{'d-none' if(acquirers_count &gt; 1 and pms_count==0 and acquirers[0]!=acq) else 'd-none' if pms_count &gt;0 else ''}}">
                                    <div class="clearfix">
                                        <input type="hidden" t-if="(verify_validity==True or mode == 'manage') and acq.check_validity" name="verify_validity" t-att-value="acq.check_validity"/>
                                        <t t-call="{{acq.sudo().get_s2s_form_xml_id()}}">
                                            <t t-set="id" t-value="acq.id"/>
                                            <t t-set="partner_id" t-value="partner_id"/>
                                            <t t-if="not return_url" t-set="return_url" t-value="''"/>
                                        </t>
                                    </div>
                                </div>
                            </t>
                        </t>
                        <t t-foreach="pms" t-as="pm">
                            <t t-if="not verify_validity or (pm.acquirer_id.check_validity and pm.verified) or not pm.acquirer_id.check_validity">
                                <div class="card-body o_payment_acquirer_select">
                                    <label>
                                        <input t-if="mode == 'payment'" type="radio" name="pm_id" t-att-value="pm.id" t-att-checked="checked_pm_id == pm.id"/>
                                        <span class="payment_option_name" t-esc="pm.name"/>
                                        <t t-if="pm.verified">
                                            <i class="fa fa-check text-success" title="This payment method is verified by our system." role="img" aria-label="Ok"></i>
                                        </t>
                                        <t t-else="">
                                            <i class="fa fa-check text-muted" title="This payment method has not been verified by our system." role="img" aria-label="Not verified"></i>
                                        </t>
                                    </label>
                                    <button t-if="mode == 'manage'" name="delete_pm" t-att-value="pm.id" class="btn btn-primary btn-sm float-right">
                                        <i class="fa fa-trash"></i> Eliminar
                                    </button>
                                </div>
                            </t>
                        </t>
                    </div>
                    <div class="row">
                        <div t-if='back_button_txt' class="col-12 col-md-6 col-xl-6 float-left mt-2">
                            <a role="button" t-att-href="back_button_link or '#'" t-att-class="back_button_class or 'btn btn-lg btn-secondary'">
                                <i t-if="back_button_icon_class" t-attf-class="fa {{back_button_icon_class}}"/>
                                <t t-esc="back_button_txt"/>
                            </a>
                        </div>
                        <div class="float-right mt-2 col-12 col-md-6 col-xl-6">
                            <button t-if="mode == 'payment'" id="o_payment_form_pay" type="submit" t-att-class="submit_class if submit_class else 'btn btn-primary btn-lg mb8 mt8'" disabled="true">
                                <t t-if="submit_txt">
                                    <i t-if="icon_class and not icon_right" t-attf-class="fa {{icon_class}}"/>
                                    <t t-esc="submit_txt"/>
                                    <i t-if="icon_class and icon_right" t-attf-class="fa {{icon_class}}"/>
                                </t>
                                <t t-else="">
                                    <i class="fa fa-lock"/> Pay
                                </t>
                            </button>
                            <t t-if="show_manage_btn">
                                <a class="btn btn-link mb8 mt8" href="/my/payment_method">Manage your payment methods</a>
                            </t>
                            <button t-if="mode == 'manage' and list(filter(lambda x: x.payment_flow == 's2s', acquirers))" type="submit" id="o_payment_form_add_pm" class="btn btn-primary btn-lg mb8 mt8">
                                <i class="fa fa-plus-circle"/> Add new card
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </template>
    <template id="payment_imagen">
        <div class="detail-sale" id="payment-page">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-7 col-xl-7 order-md-1 order-xl-1 order-2">
                        <div class="container">
                            <h5 class="shopping-title">DIRECCIONES</h5>
                            <hr/>
                             <div class="row">
                                <div class="col-12 col-md-12 col-xl-12 mb-4 mt-2" id="shipping_and_billing">
                                    <a class='float-right no-decoration text-red-hands font-size-10 a-link-imagen' href='/shop/checkout'><i class="fa fa-edit"/> Editar</a>
                                    <t t-set="same_shipping" t-value="bool(order.partner_shipping_id==order.partner_id or only_services)" />
                                    <div class="text-red-hands "><b>Facturación<t t-if="same_shipping and not only_services"> &amp; Envío</t>: </b><span t-esc='order.partner_id' t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')" class="address-inline font-size-12 mt-1"/></div>
                                    <div class="text-red-hands" t-if="not same_shipping and not only_services" groups="sale.group_delivery_invoice_address"><b>Envío: </b><span t-esc='order.partner_shipping_id' t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')"  class="address-inline font-size-12 mt-1"/></div>
                                </div>
                            </div>
                        </div>
                        <div class="container" id="payment_method">
                            <h5 class="shopping-title">MÉTODOS DE PAGO</h5>
                            <hr/>
                            <t t-call="sitio_imagen.payment_methods_imagen">
                                <t t-set="mode" t-value="'payment'"/>
                                <t t-set="submit_txt">Pagar ahora</t>
                                <t t-set="icon_right" t-value="1"/>
                                <t t-set="icon_class" t-value="'fa-chevron-right'"/>
                                <t t-set="submit_class" t-value="'btn btn-custom w-sm-100'"/>
                                <t t-set="pms" t-value="tokens"/>
                                <t t-set="form_action" t-value="'/shop/payment/token'"/>
                                <t t-set="prepare_tx_url" t-value="'/shop/payment/transaction/'"/>
                                <t t-set="partner_id" t-value="partner"/>

                                <t t-set="back_button_icon_class" t-value="'fa-chevron-left'"/>
                                <t t-set="back_button_txt">Regresar al carrito</t>
                                <t t-set="back_button_class" t-value="'btn btn-custom w-sm-100'"/>
                                <t t-set="back_button_link" t-value="'/shop/cart'"/>
                            </t>
                        </div>
                    </div>
                    <div class="col-12 col-md-5 col-xl-5 order-md-2 order-xl-2 order-1">
                        <t t-set="show_buy" t-value="0"/>
                        <t t-call="sitio_imagen.invoice_address"/>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            document.body.classList.add('page');
        </script>
    </template>

    <!--Confirmacion-->
    <template id="confirmation_imagen">
        <div class="detail-sale">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12">
                        <div class="container">
                            <h5 class="shopping-title">CONFIRMACIÓN DE ORDEN</h5>
                            <hr/>
                            <div class="row">
                                <div class="col-12 col-md-7 col-xl-7">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-12 col-md-12 col-xl-12">
                                                <h5 class="text-center confirmation-title mb-3">
                                                    <span>ORDEN </span>
                                                    <em t-field="order.name"/>
                                                    <t t-if="order.state == 'sale'">
                                                        <span>CONFIRMADA</span>
                                                    </t>
                                                </h5>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12 col-md-12 col-xl-12">
                                                <t t-set="payment_tx_id" t-value="order.get_portal_last_transaction()"/>
                                                <t t-if="payment_tx_id.state == 'done'">
                                                    <div class="row">
                                                        <div class="col-12 col-md-12 col-xl-12">
                                                            <h2 class="text-center font-size-14 other-title">¡Gracias por realizar su orden!.</h2>
                                                        </div>
                                                    </div>
                                                </t>
                                            </div>
                                        </div>
                                        <t t-if="request.env['res.users']._get_signup_invitation_scope() == 'b2c' and request.website.is_public_user()">
                                             <div class="row">
                                                 <div class="col-12 col-md-12 col-xl-12">
                                                     <p class="alert alert-info mt-3" role="status">
                                                         <a role="button" t-att-href='order.partner_id.signup_prepare() and order.partner_id.with_context(relative_url=True).signup_url' class='btn'>
                                                             Iniciar sesion
                                                         </a>
                                                         para continuar su orden.
                                                     </p>
                                                 </div>
                                             </div>
                                        </t>
                                        <div class="row">
                                            <div class="container">
                                                <div class="row">
                                                    <div class="col-12 col-md-12 col-xl-12 ml-3">
                                                        <h6 class="text-left title-confirm-order">INFORMACIÓN DE PAGO</h6>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-12 col-md-6 co-xl-6 ml-3">
                                                        <div class="row">
                                                            <div class="col-6 col-md-6 col-xl-6">
                                                                <p class="text-left" t-esc="order.get_portal_last_transaction().acquirer_id.name"></p>
                                                            </div>
                                                            <div class="col-6 col-md-3 col-xl-3">
                                                                <p class="text-right">Total:</p>
                                                            </div>
                                                            <div class="col-6 col-md-3 col-xl-3">
                                                                <p class="text-left">
                                                                    <strong t-field="order.amount_total" t-options="{'widget': 'monetary', 'display_currency': order.pricelist_id.currency_id}" />
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <t t-call="sitio_imagen.payment_confirmation_status_imagen"/>

                                        <div class="row">
                                            <div class="col-12 col-md-12 col-xl-12">
                                                <t t-set="same_shipping" t-value="bool(order.partner_shipping_id==order.partner_id or only_services)" />
                                                <div>
                                                    <b class="other-title">Facturación <t t-if="same_shipping and not only_services"> &amp; Envío</t>: </b>
                                                    <span t-esc='order.partner_id' t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')" class="address-inline"/>
                                                </div>
                                                <div t-if="not same_shipping and not only_services" groups="sale.group_delivery_invoice_address">
                                                    <b class="other-title">Envío: </b>
                                                    <span t-esc='order.partner_shipping_id' t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')"  class="address-inline"/>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-12 col-md-12 col-xl-12">
                                                <a role="button" class="btn btn-custom w-sm-100" href="/shop/print" target="_blank" aria-label="Orden de Venta" title="Orden de Venta">
                                                    <i class="fa fa-print"></i> Imprimir orden
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-5 col-xl-5">
                                    <t t-set="website_sale_order" t-value="order"/>
                                    <t t-set="show_buy" t-value="0"/>
                                    <t t-call="sitio_imagen.invoice_address"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            document.body.classList.add('page');
        </script>
    </template>

    <template id="payment_confirmation_status_imagen">
        <div class="mt-3" t-att-data-order-id="order.id">
            <t t-set="payment_tx_id" t-value="order.get_portal_last_transaction()"/>
            <!--
            <div t-attf-class="container #{
                (payment_tx_id.state == 'pending' and 'bg-info') or
                (payment_tx_id.state == 'done' and 'alert-success') or
                (payment_tx_id.state == 'authorized' and 'alert-success') or
                'bg-danger'}">
             -->
            <t t-if="payment_tx_id.state == 'pending'">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12">
                        <t t-raw="payment_tx_id.acquirer_id.pending_msg"/>
                    </div>
                </div>
            </t>
            <t t-if="payment_tx_id.state == 'done'">
                <div class="row">
                    <div t-if='payment_tx_id.acquirer_id.done_msg' class="col-12 col-md-12 col-xl-12">
                        <div  t-raw="payment_tx_id.acquirer_id.done_msg"></div>
                    </div>
                </div>
            </t>
            <t t-if="payment_tx_id.state == 'cancel'">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12">
                        <t t-raw="payment_tx_id.acquirer_id.cancel_msg"/>
                    </div>
                </div>
            </t>

            <t t-if="payment_tx_id.state == 'authorized'">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12">
                        <p class="text-left other-title">Su pago ha sido autorizado.</p>
                    </div>
                </div>
            </t>
            <t t-if="payment_tx_id.state == 'error'">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12">
                        <div t-esc="payment_tx_id.state_message"></div>
                    </div>
                </div>
            </t>

            <div class="row">
                <div class="col-12 col-md-12 col-xl-12">
                    <p class="text-left">
                        <span class="other-title"><strong>Referencia: </strong></span>
                        <span t-esc='order.reference'/>
                    </p>
                </div>
            </div>

            <div t-if="(payment_tx_id.acquirer_id.qr_code == True) and (payment_tx_id.acquirer_id.provider == 'transfer') and (payment_tx_id.currency_id.name == 'EUR')">
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12" t-if="payment_tx_id.acquirer_id.journal_id.bank_account_id.qr_code_valid">
                        <h3 class="text-left other-title">O escanéame con tu aplicación bancaria.</h3>
                        <img class="border border-dark rounded"
                             t-att-src="payment_tx_id.acquirer_id.journal_id.bank_account_id.build_qr_code_url(order.amount_total,payment_tx_id.reference)"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-md-12 col-xl-12" t-if="payment_tx_id.acquirer_id.journal_id.bank_account_id.qr_code_valid == False">
                        <h3 class="text-center other-title">
                            La información del código QR SEPA no está configurada correctamente.
                        </h3>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="payment_sale_note_imagen" inherit_id="payment_imagen" name="Accept Terms &amp; Conditions">
        <xpath expr="//div[@id='payment_method']" position="after">
            <div class="custom-control custom-checkbox float-right mt-2 oe_accept_cgv_button">
                <input type="checkbox" id="checkbox_cgv" class="custom-control-input"/>
                <label for="checkbox_cgv" class="custom-control-label text-red-hands font-size-12">
                    Estoy de acuerdo con los <a target="_BLANK" href="/shop/terms">terminos &amp; condiciones</a>
                </label>
            </div>
        </xpath>
    </template>

    <template id="payment_process_imagen" inherit_id="payment.payment_process_page">
        <xpath expr="//div[@class='wrap']" position="replace">
            <div class="detail-sale">
                 <div class="container o_website_payment">
                    <div class="o_payment_processing">
                        <div class="row">
                            <div class="o_payment_processing_content col-sm-6 col-sm-offset-3">
                                <!-- The content here is generated in JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                document.body.classList.add('page');
            </script>
        </xpath>
    </template>

</odoo>